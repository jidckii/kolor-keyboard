# Конфигурация kolor-keyboard для Keychron V3 - VIAL прошивка, режим FLAGS (per-key RGB)
# Рисует флаги стран на клавиатуре
# Требует прошивку Vial (см. docs/FIRMWARE.md)

device:
  vendor_id: 0x3434
  product_id: 0x0331
  usage_page: 0xFF60
  usage: 0x61

firmware: vial
mode: flags

# Раскладка LED для Keychron V3 ANSI Encoder (87 LEDs)
# Индексы LED для каждого ряда клавиатуры
keyboard:
  rows:
    # Row 0: ESC, F1-F12, PrintScr, Pause, Delete (16 LEDs: 0-15)
    - [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
    # Row 1: ~, 1-0, -, =, Backspace, Insert, Home, PgUp (17 LEDs: 16-32)
    - [16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
    # Row 2: Tab, Q-P, [, ], \, Delete, End, PgDn (17 LEDs: 33-49)
    - [33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
    # Row 3: Caps, A-L, ;, ', Enter (13 LEDs: 50-62)
    - [50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62]
    # Row 4: LShift, Z-M, comma, period, /, RShift, Up (13 LEDs: 63-75)
    - [63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75]
    # Row 5: Ctrl, Win, Alt, Space, Alt, Fn, Ctrl, Left, Down, Right (11 LEDs: 76-86)
    - [76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86]

flags:
  # Флаг России: Белый / Синий / Красный (горизонтальные полосы)
  - layout: ru
    stripes:
      - rows: [0, 1]       # Верхние 2 ряда - белый
        color: {r: 255, g: 255, b: 255}
      - rows: [2, 3]       # Средние 2 ряда - синий
        color: {r: 0, g: 50, b: 255}
      - rows: [4, 5]       # Нижние 2 ряда - красный
        color: {r: 255, g: 0, b: 0}

  # Флаг США: синий угол (canton) + чередующиеся красно-белые полосы
  # LED Map: см. docs/LED_MAP.md
  - layout: us
    stripes:
      # Синий canton (левый верхний угол, 3 ряда по 7 клавиш)
      - leds: [0, 1, 2, 3, 4, 5, 6]         # Row 0: ESC, F1-F6
        color: {r: 0, g: 50, b: 180}
      - leds: [16, 17, 18, 19, 20, 21, 22]  # Row 1: ~, 1-6
        color: {r: 0, g: 50, b: 180}
      - leds: [33, 34, 35, 36, 37, 38, 39]  # Row 2: Tab, Q-Y
        color: {r: 0, g: 50, b: 180}

      # Красные полосы (начинаются справа от canton + целые ряды)
      - leds: [7, 8, 9, 10, 11, 12, 13, 14, 15]         # Row 0 right: F7-Light
        color: {r: 255, g: 0, b: 0}
      - leds: [23, 24, 25, 26, 27, 28, 29, 30, 31, 32]  # Row 1 right: 7-PgUp
        color: {r: 255, g: 0, b: 0}
      - leds: [40, 41, 42, 43, 44, 45, 46, 47, 48, 49]  # Row 2 right: U-PgDn
        color: {r: 255, g: 0, b: 0}
      - rows: [4]  # Row 4 full: LShift-Up (LED 63-75)
        color: { r: 255, g: 0, b: 0 }
      - rows: [5]  # Row 5 full: LCtrl-Right (LED 76-86)
        color: { r: 255, g: 0, b: 0 }

      # Белые полосы
      - leds: [40, 41, 42, 43, 44, 45, 46, 47, 48, 49]  # Row 2 right: U-PgDn
        color: {r: 255, g: 255, b: 255}
      - rows: [3]  # Row 3 full: Caps-Enter (LED 50-62)
        color: {r: 255, g: 255, b: 255}

  # Fallback - зелёный
  - layout: "*"
    stripes:
      - rows: [0, 1, 2, 3, 4, 5]
        color: {r: 0, g: 255, b: 0}
